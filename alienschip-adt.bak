;;            ----------------
;; ----------  Alienschip ADT  ----------
;;            ----------------


(define (maak-alienschip positie)
  (let ((status 'actief)
        (kleur #f)
        (levens #f))

    ; de beweeg! functie die de beweeg van positie gaat aanroepen
    ; om zo het alienschip naar een bepaalde richting te laten bewegen afhankelijk van het richtingsargument
    (define (beweeg! richting)
      (if (eq? status 'actief)
          ((positie 'beweeg!) richting)))


    ; rand-geraakt? : / -> /
    (define (rand-geraakt?)
      ((positie 'rand?)))

    ; schiet! operatie gaat een nieuwe kogel aanmaken op de positie van het alienschip
    (define (schiet!)
      (maak-kogel positie))

    ; kleur! gaat de kleur/soort van de huidige alien aanpassen naar een nieuwe kleur
    (define (kleur! nieuwe_kleur)
      (set! kleur nieuwe_kleur))

    ; levens! gaat het aantal levens van de huidige alien instellen
    (define (levens! aantal_levens)
      (set! levens aantal_levens))

    ; zet de status van de huidige alien op inactief
    (define (zet-inactief!)
      (set! status 'inactief))
      

    ; de dispatch functie
    (define (dispatch-alienschip msg)
      (cond((eq? msg 'beweeg) beweeg!)
           ((eq? msg 'positie) positie)
           ((eq? msg 'schiet) schiet!)
           ((eq? msg 'rand-geraakt?) rand-geraakt?)
           ((eq? msg 'kleur) kleur)
           ((eq? msg 'kleur!) kleur!)
           ((eq? msg 'levens) levens)
           ((eq? msg 'levens!) levens!)
           ((eq? msg 'status) status)
           ((eq? msg 'zet-inactief!) zet-inactief!)
           (else (display "ongeldige boodschap - alienschip"))))
    dispatch-alienschip))